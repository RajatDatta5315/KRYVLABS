<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KRYV LABS | OS-1 COMMAND</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;600&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #06b6d4; --bg: #020202; }
        body { background: var(--bg); color: white; font-family: 'Space Grotesk', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); backdrop-filter: blur(20px); }
        .terminal-input { background: transparent; border: none; color: var(--accent); font-family: 'JetBrains Mono'; width: 100%; outline: none; }
        .loading-bar { height: 2px; background: var(--accent); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            const [agents, setAgents] = useState([
                { id: '1', name: 'NEURAL_PHX', status: 'idle', task: null, load: 12 },
                { id: '2', name: 'VOID_RUNTIME', status: 'idle', task: null, load: 45 }
            ]);
            const [selectedAgent, setSelectedAgent] = useState(agents[0]);
            const [command, setCommand] = useState('');
            const [logs, setLogs] = useState([{ t: '12:00:00', m: 'OS_BOOT_SEQUENCE_COMPLETE' }]);

            const log = (m) => setLogs(prev => [{ t: new Date().toLocaleTimeString(), m }, ...prev]);

            const executeCommand = (e) => {
                e.preventDefault();
                if (!command) return;

                log(`CMD_INIT: ${command} -> ${selectedAgent.name}`);
                
                // Real-world logic: Update local state immediately (Optimistic UI)
                const updatedAgents = agents.map(a => 
                    a.id === selectedAgent.id ? { ...a, status: 'executing', task: command } : a
                );
                setAgents(updatedAgents);
                
                // Simulate backend processing
                setTimeout(() => {
                    log(`EXE_COMPLETE: ${selectedAgent.name} finished task.`);
                    setAgents(prev => prev.map(a => 
                        a.id === selectedAgent.id ? { ...a, status: 'idle', task: null, load: Math.floor(Math.random() * 80) } : a
                    ));
                }, 3000);

                setCommand('');
            };

            return (
                <div className="h-screen flex flex-col p-6 lg:p-10 gap-6">
                    {/* Header */}
                    <header className="flex justify-between items-center glass p-6 rounded-2xl">
                        <div className="flex items-center gap-4">
                            <div className="w-10 h-10 bg-cyan-500 rounded-lg flex items-center justify-center font-bold text-black">K</div>
                            <h1 className="text-xl font-bold tracking-tighter uppercase">KRYV <span className="text-cyan-500">Orchestrator</span></h1>
                        </div>
                        <div className="mono text-xs text-zinc-500">SYSTEM_STATUS: <span className="text-emerald-500">NOMINAL</span></div>
                    </header>

                    <div className="flex-1 grid grid-cols-12 gap-6 overflow-hidden">
                        {/* Fleet List */}
                        <div className="col-span-12 lg:col-span-4 flex flex-col gap-4 overflow-y-auto">
                            {agents.map(agent => (
                                <div 
                                    key={agent.id}
                                    onClick={() => setSelectedAgent(agent)}
                                    className={`glass p-6 rounded-2xl cursor-pointer transition-all border-l-4 ${selectedAgent.id === agent.id ? 'border-cyan-500 bg-white/5' : 'border-transparent opacity-60'}`}
                                >
                                    <div className="flex justify-between items-start mb-4">
                                        <h3 className="font-bold uppercase tracking-widest">{agent.name}</h3>
                                        <span className={`text-[10px] mono px-2 py-1 rounded bg-black ${agent.status === 'executing' ? 'text-amber-400' : 'text-emerald-400'}`}>
                                            {agent.status}
                                        </span>
                                    </div>
                                    <div className="space-y-2">
                                        <div className="flex justify-between text-[10px] mono text-zinc-500 uppercase">
                                            <span>Neural Load</span>
                                            <span>{agent.load}%</span>
                                        </div>
                                        <div className="h-1 bg-white/5 rounded-full overflow-hidden">
                                            <div className="h-full bg-cyan-500" style={{ width: `${agent.load}%` }}></div>
                                        </div>
                                    </div>
                                    {agent.task && (
                                        <div className="mt-4 pt-4 border-t border-white/5">
                                            <p className="text-[10px] mono text-cyan-500 uppercase animate-pulse">Running: {agent.task}</p>
                                        </div>
                                    )}
                                </div>
                            ))}
                        </div>

                        {/* Control Console */}
                        <div className="col-span-12 lg:col-span-8 flex flex-col gap-6">
                            <div className="glass flex-1 rounded-3xl p-8 flex flex-col relative overflow-hidden">
                                <div className="absolute top-0 left-0 w-full h-1 bg-cyan-500/20"></div>
                                
                                {/* Console Logs */}
                                <div className="flex-1 overflow-y-auto mono text-xs space-y-3 mb-6 flex flex-col-reverse">
                                    {logs.map((l, i) => (
                                        <div key={i} className="flex gap-4 border-b border-white/5 pb-2">
                                            <span className="text-zinc-600">[{l.t}]</span>
                                            <span className={l.m.includes('CMD') ? 'text-cyan-400' : 'text-zinc-400'}>{l.m}</span>
                                        </div>
                                    ))}
                                </div>

                                {/* Terminal Input */}
                                <form onSubmit={executeCommand} className="glass bg-black p-4 rounded-xl flex items-center gap-4">
                                    <span className="text-cyan-500 mono font-bold">{selectedAgent.name} ></span>
                                    <input 
                                        type="text" 
                                        className="terminal-input"
                                        placeholder="Enter instruction (e.g. 'Generate subsystem report', 'Initialize defense protocol')..."
                                        value={command}
                                        onChange={(e) => setCommand(e.target.value)}
                                        autoFocus
                                    />
                                    <button className="px-4 py-1 text-[10px] bg-cyan-500 text-black font-bold rounded uppercase">Run</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
